---
title: "HW2"
author: "Tiancheng Liu"
date: "2022-09-29"
output:
  word_document:
    toc: yes
    toc_depth: '3'
  html_document:
    toc: yes
    toc_depth: 3
    number_sections: yes
    theme: united
    highlight: tango
    css: my.css
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Question 1

### a

```{r}
dbinom(15, 30, 0.5)
```
The probability that exactly half of the rolls are even numbers is 0.144.

### b

```{r}
1-pbinom(20, 30, 0.5)
```

The probability that more than 20 of the rolls are even numbers is 0.0214.

### c

```{r}
pbinom(4, 30, 1/3)
```

The probability that less than 5 of the rolls are greater than 4 is 0.0122.

## Question 2

### a

```{r}
ppois(40, 30) - ppois(19, 30)
```

The probability that the server gets pinged between 20 and 40 times in a particular second is 0.946.

### b

```{r}
sec <- 365 * 24 * 60 * 60
sec
```

There are 31536000 seconds in a year.


### c

```{r}
max(rpois(sec, 30))
```

The maximum number of pings in a single second over the course of
a year is around 66.

### d

```{r}
qpois(0.99, 30)
```
43 should be a good rate, as it is the 99 percent threshood.

## Question 3

### a

```{r}
t <-  seq(0, 5, by=0.1)

prob3 <- dunif(t, 0, 5)

plot(t, prob3)
```

The density function are as shown.

### b

```{r}
punif(1, 0, 5)
```

The probability that the bus is more than 1 minutes late is 0.2.


### c

```{r}
(1-punif(4, 0, 5))/(1-punif(3, 0, 5))
```

The conditional probability that the bus is more than 4 minutes late, given that it
is already 3 minutes late is 0.5.


## Question 4

### a

```{r}
1 - pnorm(60, 50, 5)

step <- seq(0, 100, by=0.01)
prob4 <- dnorm(step, 50, 5)
plot(step, prob4)
abline(v = 60)
polygon(c(step[step>=60], max(step), 60), c(prob4[step>=60],0,0), col="red")
```

The probability that it is more than 60 cm in length is 0.0227.



### b

```{r}
qnorm(0.1, 50, 5)
plot(step, prob4)
polygon(c(step[step<=43],43, 40), c(prob4[step<=43],0,0), col="red")
```


The length is 43.59.


### c

```{r}
qnorm(0.3, 50, 5)
plot(step, prob4)
polygon(c(step[step>=47],47, 47), c(prob4[step>=47],0,0), col="red")
```

The length is 47.38.


## Question 5

### a

```{R}
pnorm(90, 80, 10) - pnorm(70, 80, 10)
```

### b

```{r}
pnorm(100, 80, 10) - pnorm(60, 80, 10)
```

### c

```{r}
pnorm(110, 80, 10) - pnorm(50, 80, 10)
```

### d

```{r}
for (i  in 1:3){
  print(pnorm(0 + i * 1, 0, 1) - pnorm(0 - i * 1, 0, 1))
}
```

## Question 6

### a

```{r}
pnorm(1.9, 2, 0.05)
```

2.27 percent of nails are less than 1.9 inches in length.

### b

```{r}
1 - pnorm(2.1, 2, 0.05)
```

2.27 percent of nails are longer than 2.1 inches in length.

### c

```{r}
qnorm(0.8, 2, 0.05)
```

Exactly 20% of the nails are longer than 2.04.


### d

```{R}
qnorm(0.2, 2, 0.05)
```

Exactly 20% of the nails are shorter than 1.958.

## Question 7

### a

```{r}
sim <- rpois(10000, 20)
hist(sim)
```

### b

```{R}
simb <- c()
for (i in sim){
  simb <- append(simb, rbinom(1, i, 0.08))
}

hist(simb)
```


### c

```{r}
simc <- c()
for (i in simb){
  simc <- append(simc, sum(rexp(i, 1/10000000)))
}
hist(simc)
```

### d

```{r}
mean((simc - 26000000) > 0)
```

About 22.76 percent of the simulation makes a profit.


### e

```{r}
sim_RD <- rpois(10000, 24)
rt_RD <- c()
for(i in sim_RD){
  rt_RD <- append(rt_RD, rbinom(1, i, 0.08))
}
rev_RD <- c()
for(j in rt_RD){
  rev_RD <- append(rev_RD, sum(rexp(j, 1/10000000)))
}
mean(rev_RD)

rev_market <- c()
for (k in simb){
  rev_market <- append(rev_market, sum(rexp(k, 1/12000000)))
}
mean(rev_market)

```

With different runs the result are different, sometimes one is higher sometimes the other one is higher. But most of the time marketing revenue is higher, Thus I conclude that spend money on marketing will yield higher revenue.
