---
title: "HW1 STT810 Tiancheng Liu"
author: "Tiancheng Liu"
date: "2022-09-12"
output:
  word_document:
    toc: yes
    toc_depth: '3'
  html_document:
    toc: yes
    toc_depth: 3
    number_sections: yes
    theme: united
    highlight: tango
    css: my.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Question 1

### a

```{r}
samp <- sample(c(1:6),100,replace = TRUE)
samp
```


### b

```{r}
mean(samp)
```

### c

```{r}
samp1000 <- sample(c(1:6),1000,replace = TRUE)
mean(samp1000)

samp10000 <- sample(c(1:6),10000,replace = TRUE)
mean(samp10000)

samp100000 <- sample(c(1:6),100000,replace = TRUE)
mean(samp100000)

samp1000000 <- sample(c(1:6),1000000,replace = TRUE)
mean(samp1000000)
```

Yes, the mean is approaching the true value.

### d

```{r}
samp1000 <- sample(c(0,1),1000,replace = TRUE)
mean(samp1000)

samp10000 <- sample(c(0,1),10000,replace = TRUE)
mean(samp10000)

samp100000 <- sample(c(0,1),100000,replace = TRUE)
mean(samp100000)

samp1000000 <- sample(c(0,1),1000000,replace = TRUE)
mean(samp1000000)
```

Yes,same convergence.

### e

```{r}
samp1000 <- sample(c(0,1,1),1000,replace = TRUE)
mean(samp1000)

samp10000 <- sample(c(0,1,1),10000,replace = TRUE)
mean(samp10000)

samp100000 <- sample(c(0,1,1),100000,replace = TRUE)
mean(samp100000)

samp1000000 <- sample(c(0,1,1),1000000,replace = TRUE)
mean(samp1000000)
```

Yes, the result is converging to 0.667.


## Question 2

### a

The sample space is {0,1,2,3,4,5}.

### b

6*6 there are a total of 36 possible outcomes, and if the difference is 1 then it has to be 12,23,34,45,56,65,54,43,32,21, a total of 10 outcomes. Then the probability is 10/36 = 0.278

### c


```{r}
fir <- sample(c(1:6),10000,replace = TRUE)
sec <- sample(c(1:6),10000,replace = TRUE)
dif <- abs(fir-sec)
sum(dif == 1)/length(dif)
```
We can see the result agrees on what we have in b.

## Qustion 3

### a

Dice 1, coin 1 head*2
Dice 2, coin 2 head.

(1+2)/4*6 = 0.125 chance to win the game.

### b

```{r}

count <- 0

for (i in 1:10000){
  dice <- sample(c(1:6),1,replace = T)
  coin <- sample(c(0,1),2,replace = T)
  if (dice == sum(coin)){
    count = count + 1
  }
}
count/10000
```

The probability to win the game is about 0.125.


## Question 4

Let 

A : a viewer watched gymnastics
B : a viewer watched baseball
C : a viewer watched soccer

We have 


```{r}
library(VennDiagram)
draw.triple.venn(area1=28, area2=29, area3=19,
                 n12=14, n23=12, n13=10, n123=8,
                 category=c("gymnastics","baseball","soccer"),
                 col="Red",fill=c("Green","Yellow","Blue"))
```


Thus the result should be (100-28-29-19+14+12+10+8)/100 = 0.68. 

68 percent of the group watched none of the three sports during the last year.

## Question 5 Matloff 1.9


Skipped for the question is incorrect.


## Question 6 Matloff 1.10

### a

```{r}
Pn3n4 <- 2/4
Pn3n4
```

Thus the answer for a is 0.5.

### b

```{r}
pn43 <- (1/2)*(1/4)+(1/2)*(1/4) #p(n3=1 and n4=3) +  p(n3=2 and n4=3)
pn43
```


Thus the answer is 0.25.


## Question 7 Matloff 2.1

```{r}
minpiece <- function(k) {
  breakpts <- sort(runif(k-1))
  lengths <- diff(c(0,breakpts ,1))
  min(lengths)
}
# returns the approximate probability
# that the smallest of k pieces will
# have length less than q
bkrod <- function(nreps ,k,q) {
  minpieces <- replicate(nreps ,minpiece(k))
  mean(minpieces < q)
}
bkrod(10000,5,0.02)


#here is the modified function
bkrod(10000,sample(c(2,3,4),1,replace = T,prob = c(0.3,0.3,0.4)),0.02)
```

The probability is shown above.

## question 8 Matloff 2.6

```{r}
nreps <- 10000
nstops <- 9 # because the 10th arrival is the same as 9th departure
count <- 0
pas_tt <- rep(0,10000)
for (i in 1:nreps){
  pas_lis <- 0
  passengers <- 1
  for (j in 1:nstops) {
    if (passengers > 0){
      for (k in 1:passengers){
        if (runif(1) < 0.2)
          passengers <- passengers - 1
      }
    }
    newpass <- sample(0:2,1,prob=c(0.5,0.4,0.1))
    passengers <- passengers + newpass
    if (passengers == 0){
      pas_lis <- 1
    }
  }
  pas_tt[i] <- pas_lis
}

sum(pas_tt)/10000
```

Thus we can see that, it about 30% chance the bus will be empty for at least one stop.
  
  
  
  
  
  
  
  
  









